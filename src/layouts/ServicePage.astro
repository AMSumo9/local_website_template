---
// src/layouts/ServicePage.astro
import BaseLayout from './BaseLayout.astro';
import { Image } from 'astro:assets';
import defaultServiceImage from '../assets/images/hero/default-service.png';
import projectData from '../data/project.json';
import LeadMagnet from '../components/LeadMagnet.astro'; // <-- 1. IMPORT

const siteData = projectData;

export interface Props {
	frontmatter: {
		title: string;
		meta_description: string;
		subtitle?: string;
		excerpt?: string;
		hero_highlight?: string;
		hero_image?: string; 
		service_type?: string;
		key_benefits?: { icon: string; title: string; description: string }[];
		features_title?: string;
	};
}

const { frontmatter } = Astro.props;
const pageData = { ...frontmatter, layout: 'services' };
const imageUrl = frontmatter.hero_image 
    ? `/images/hero/${frontmatter.hero_image}` // <-- Updated path
    : defaultServiceImage;
const imageAlt = `${frontmatter.title.split(' | ')[0]} illustration`;
const displayTitle = frontmatter.title.replace(` | ${siteData.company.name}`, '');
---
<BaseLayout siteData={siteData} pageData={pageData}>

	<section class="bg-brand-accent">
		<div class="container mx-auto px-6 py-16 grid md:grid-cols-2 gap-12 items-center">
			<div>
                <h1 class="text-4xl md:text-5xl font-extrabold text-[var(--text-primary)] mb-4" set:html={
                    frontmatter.hero_highlight
                        ?
displayTitle.replace(frontmatter.hero_highlight, `<span class="text-brand-primary">${frontmatter.hero_highlight}</span>`)
                        : displayTitle
                } />
				
				{frontmatter.subtitle && <p class="text-xl text-[var(--text-secondary)] mb-6">{frontmatter.subtitle}</p>}
				{frontmatter.excerpt && <p class="text-lg text-[var(--text-secondary)] mb-6">{frontmatter.excerpt}</p>}
				
				<button id="service-hero-open-modal" class="inline-block bg-brand-primary text-white font-bold text-lg px-8 py-4 rounded-lg shadow-xl hover:bg-brand-primary-dark transition duration-300">
					{siteData.cta.primary ||
'Start Your Comparison'}
				</button>
			</div>
			<div>
                <Image 
                  src={imageUrl} 
                  alt={imageAlt} 
                  class="rounded-lg shadow-2xl w-full h-auto aspect-[4/3] object-cover" 
                  format="webp" 
                  quality={80} 
                />
			</div>
		</div>
	</section>

	{frontmatter.key_benefits && frontmatter.key_benefits.length > 0 && (
		<section class="py-20 bg-white">
			<div class="container 
 mx-auto px-6">
				<div class="text-center mb-12">
					<h2 class="text-3xl font-bold text-[var(--text-primary)]">
						{frontmatter.features_title || `The Smarter Way to ${frontmatter.service_type || 'Get Your Loan'}`}
					</h2>
					<p class="mt-2 text-lg text-[var(--text-secondary)]">Discover the features and benefits.</p>
				</div>
				
				<div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
					{frontmatter.key_benefits.map(benefit => (
						<div class="bg-gray-50 p-6 rounded-lg shadow-md">
							{benefit.icon && <i class:list={[benefit.icon, "text-4xl text-brand-primary mb-4"]}></i>}
							<h3 class_name="text-xl font-semibold mb-2 text-[var(--text-primary)]">{benefit.title}</h3>
							<p class_name="text-[var(--text-secondary)]">{benefit.description}</p>
						</div>
					))}
				</div>
			</div>
		</section>
	)}

	<section class="py-10 md:py-20 bg-white">
		<div class="container mx-auto px-6">
			<article class="prose lg:prose-lg max-w-4xl 
 mx-auto text-[var(--text-primary)] prose-headings:text-[var(--text-primary)] prose-a:text-brand-primary hover:prose-a:text-brand-primary-dark">
				<slot />
			</article>
      
      <div class="max-w-4xl mx-auto">
        <LeadMagnet />
      </div>

		</div>
	</section>

</BaseLayout>